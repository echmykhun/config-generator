/**
 * Created by yevhen_chmykhun on 13.10.15.
 */
var constants = require('./../constants.json');
var util = require('./../util');

module.exports = function (gen, next) {


  var generator = gen, nextPrompt = next;

  var generalPrompt = function () {
    var generalPromptPromiseFunc = function (resolve, reject) {
      var generalPromptOptions = {
        type: 'input',
        name: 'name',
        message: "Wellcome to config generator. \n Enter your app name and press Enter to start",
        default: generator.configObject.appName || "GeneratedProject",
        validate: util.validateName
      };
      var generalPromptCallback = function (answers) {
        generator.configObject.appName = answers.name.capitalizeFirstLetter().makeCamelCase();
        util.saveConfig(generator.configObject, generator.configFileName);
        resolve();
      };
      generator.prompt(generalPromptOptions, generalPromptCallback);
    };
    return new Promise(generalPromptPromiseFunc).then(afterGeneralPrompt);
  };
  var afterGeneralPrompt = function () {
    return nextPrompt ? nextPrompt() : false
  };

  return generalPrompt;
};
